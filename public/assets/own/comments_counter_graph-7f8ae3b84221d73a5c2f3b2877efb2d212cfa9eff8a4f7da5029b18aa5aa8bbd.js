var create_comment_graph=function(t,e){function n(){for(var t=0;t<i.length;t++){c[t]=[];for(var e=0;e<i[t].length;e++)c[t].push(i[t][e])}}function a(){function t(t){w.select(".heat_map").selectAll(".row_"+t).data(i[t]).on("mouseover",function(e,n){w.select(".heat_map").append("rect").attr("class","text_back").attr({width:30,height:18,x:function(){if(1!=z)return A.left+31*n+1;for(var t=0;t<s.length;t++)if(n==p[t])return A.left+31*(s.length-1-t)+1},y:function(){if(1!=z)return A.top+31*t-25;for(var e=0;e<s.length;e++)if(t==f[e])return A.top+31*(s.length-1-e)-25},fill:"#000000",opacity:.5}),w.select(".heat_map").append("path").attr("class","arrow").attr({d:function(){if(1!=z)return"M "+(A.left+31*n+16)+" "+(A.top+31*t)+"l 5 -5l -10 0l 5 5";for(var e=0;e<s.length;e++)if(n==p[e])for(var a=0;a<s.length;a++)if(t==f[a])return"M "+(A.left+31*(s.length-1-e)+16)+" "+(A.top+31*(s.length-1-a))+"l 5 -5l -10 0l 5 5"},stroke:"#000000","stroke-width":1,fill:"#000000",opacity:.5}),w.select(".heat_map").append("text").attr("class","comment_num").text(i[t][n]).attr({x:function(){if(1!=z)return A.left+31*n+16;for(var t=0;t<s.length;t++)if(n==p[t])return A.left+31*(s.length-1-t)+16},y:function(){if(1!=z)return A.top+31*t-15;for(var e=0;e<s.length;e++)if(t==f[e])return A.top+31*(s.length-1-e)-15},"font-family":"sans-serif","font-size":"10px","text-anchor":"middle","dominant-baseline":"middle",fill:"#ffffff",opacity:1})}).on("mouseout",function(){w.select(".heat_map").selectAll(".comment_num").remove(),w.select(".heat_map").selectAll(".arrow").remove(),w.select(".heat_map").selectAll(".text_back").remove()})}w.append("g").attr({"class":"heat_map",transform:"translate("+y.left+", "+y.top+")"}),w.select(".heat_map").append("text").attr("class","title").text("\u30b3\u30e1\u30f3\u30c8\u6570\u306e\u9001\u53d7\u4fe1\u6570").attr({x:A.left+31*s.length+40,y:A.top-50,"font-family":"sans-serif","font-size":"20px","font-weight":"bold","text-anchor":"start","dominant-baseline":"middle",fill:"#777777",opacity:1});for(var e=0;e<i.length;e++)w.select(".heat_map").selectAll(".data").data(i[e]).enter().append("g").attr("class","row_"+e).append("g").attr("class",function(t,e){return"column_"+e}).append("rect").attr("class","cell").attr({width:31,height:31,x:function(t,e){return A.left+31*e},y:A.top+31*e,fill:x,opacity:function(t){return 0!=t&&0!=g?t/g:0}});for(var e=0;e<s.length;e++)t(e);w.select(".heat_map").selectAll(".row_border").data(s).enter().append("path").attr("class",function(t,e){return"row_border"}).attr({d:function(t,e){return M([[A.left+0,A.top+31*e],[A.left+31*s.length,A.top+31*e]])},stroke:"#aaaaaa","stroke-width":1,opacity:1}),w.select(".heat_map").selectAll(".column_border").data(s).enter().append("path").attr("class",function(t,e){return"column_border"}).attr({d:function(t,e){return M([[A.left+31*e,A.top],[A.left+31*e,A.top+31*s.length]])},stroke:"#aaaaaa","stroke-width":1,opacity:1});var n=[[[A.left,A.top],[A.left+31*s.length,A.top]],[[A.left+31*s.length,A.top],[A.left+31*s.length,A.top+31*s.length]],[[A.left,A.top+31*s.length],[A.left+31*s.length,A.top+31*s.length]],[[A.left,A.top],[A.left,A.top+31*s.length]]];w.select(".heat_map").selectAll(".edge_line").data(n).enter().append("path").attr("class","edge_line").attr({d:function(t,e){return M(n[e])},stroke:"#aaaaaa","stroke-width":1,opacity:1}),w.select(".heat_map").append("text").attr("class","row_term_label").text("\u9001\u4fe1\u8005").attr({x:A.left-15,y:A.top-10,"font-family":"sans-serif","font-size":"10px","text-anchor":"end","dominant-baseline":"middle",fill:"#777777",opacity:1}),w.select(".heat_map").append("text").attr("class","row_term_label").text("\u53d7\u4fe1\u8005").attr({x:A.left-10,y:A.top-15,"font-family":"sans-serif","font-size":"10px","text-anchor":"end","dominant-baseline":"middle","writing-mode":"tb",fill:"#777777",opacity:1}),w.select(".heat_map").selectAll(".row_developer_label").data(s).enter().append("text").attr("class","row_developer_label").text(function(t){return t}).attr({x:A.left-10,y:function(t,e){return A.top+31*e+18},"font-family":"sans-serif","font-size":"15px","text-anchor":"end","dominant-baseline":"middle",fill:"#777777",opacity:1}),w.select(".heat_map").selectAll(".column_developer_label").data(s).enter().append("text").attr("class","column_developer_label").text(function(t){return t}).attr({x:function(t,e){return A.left+31*e+16},y:A.top-10,"font-family":"sans-serif","font-size":"15px","text-anchor":"end","dominant-baseline":"middle","writing-mode":"tb",fill:"#777777",opacity:1}),w.select(".heat_map").selectAll(".send_comments_sum_label").data(u).enter().append("text").attr("class","send_comments_sum_label").text(function(t){return t}).attr({x:A.left+31*s.length+5,y:function(t,e){return A.top+31*e+18},"font-family":"sans-serif","font-size":"10px","text-anchor":"start","dominant-baseline":"middle",fill:"#777777",opacity:1}),w.select(".heat_map").selectAll(".recieve_comments_sum_label").data(h).enter().append("text").attr("class","recieve_comments_sum_label").text(function(t){return t}).attr({x:function(t,e){return A.left+31*e+16},y:A.top+31*s.length+5,"font-family":"sans-serif","font-size":"10px","text-anchor":"start","dominant-baseline":"middle","writing-mode":"tb",fill:"#777777",opacity:1})}function l(){for(var t=["#4f81bd","#c0504d"],e=["#99b6d9","#db9a98"],a=[10,8],l=["\u958b\u767a\u8005\u306e\u767b\u9332\u9806","\u30b3\u30e1\u30f3\u30c8\u6570\u9806"],r=[],o=[],d=[],m=[],_=[],g=[],x=[],v=[],b=0;b<s.length;b++)_.push(s[b]),g.push(s[b]),r.push(u[b]),o.push(h[b]),d.push(u[b]),m.push(h[b]);d.sort(function(t,e){return e>t?-1:t>e?1:0}),m.sort(function(t,e){return e>t?-1:t>e?1:0}),f=[],p=[];for(var b=0;b<s.length;b++)for(var y=0;y<s.length;y++)if(d[b]==r[y]){x.push(_[y]),r.splice(y,1,-1),_.splice(y,1,-1),f.push(y);break}for(var b=0;b<s.length;b++)for(var y=0;y<s.length;y++)if(m[b]==o[y]){v.push(g[y]),o.splice(y,1,-1),g.splice(y,1,-1),p.push(y);break}w.select(".heat_map").append("g").attr("class","sort").attr("transform","translate("+(A.left+31*s.length+40)+", "+A.top+")"),w.select(".heat_map").select(".sort").append("text").attr("class","function_name").text("Sort").attr({x:10,y:10,"font-family":"sans-serif","font-size":"15px","text-anchor":"start","dominant-baseline":"middle",fill:"#777777",opacity:1}),w.select(".heat_map").select(".sort").selectAll(".button").data(a).enter().append("circle").attr("class","button").attr({cx:20,cy:30,r:function(t,e){return a[e]},fill:function(n,a){return 0==a?e[0]:1==a?t[0]:void 0},opacity:1}),w.select(".heat_map").select(".sort").selectAll(".button").on("mouseover",function(){w.select(".heat_map").select(".sort").selectAll(".button").data(a).attr("fill",function(n,a){return 0==a?e[1]:1==a?t[1]:void 0})}).on("mouseout",function(){w.select(".heat_map").select(".sort").selectAll(".button").data(a).attr("fill",function(n,a){return 0==a?e[0]:1==a?t[0]:void 0})}).on("click",function(){if(z=(z+1)%l.length,w.select(".heat_map").select(".sort").select(".sort_name").text(l[z]),0==z){n(),w.select(".heat_map").selectAll(".row_developer_label").data(s).transition().duration(2*k).attr({y:function(t,e){return A.top+31*e+18}}),w.select(".heat_map").selectAll(".column_developer_label").data(s).transition().duration(2*k).attr({x:function(t,e){return A.left+31*e+16}});for(var t=0;t<s.length;t++)for(var e=0;e<s.length;e++)w.select(".heat_map").selectAll(".row_"+t).selectAll(".column_"+e).select(".cell").transition().duration(2*k).attr({x:function(){return A.left+31*e},y:function(){return A.top+31*t}});w.select(".heat_map").selectAll(".row_border").data(s).transition().duration(2*k).attr({d:function(t,e){return M([[A.left+0,A.top+31*e],[A.left+31*s.length,A.top+31*e]])}}),w.select(".heat_map").selectAll(".column_border").data(s).transition().duration(2*k).attr({d:function(t,e){return M([[A.left+31*e,A.top],[A.left+31*e,A.top+31*s.length]])}}),w.select(".heat_map").selectAll(".send_comments_sum_label").data(u).transition().duration(2*k).attr({y:function(t,e){return A.top+31*e+18}}),w.select(".heat_map").selectAll(".recieve_comments_sum_label").data(h).transition().duration(2*k).attr({x:function(t,e){return A.left+31*e+16}})}else if(1==z){w.select(".heat_map").selectAll(".row_developer_label").data(s).transition().duration(2*k).attr({y:function(t,e){for(var n=0;n<s.length;n++)if(u[e]==d[n])return A.top+31*(s.length-1-n)+18}}),w.select(".heat_map").selectAll(".column_developer_label").data(s).transition().duration(2*k).attr({x:function(t,e){for(var n=0;n<s.length;n++)if(h[e]==m[n])return A.left+31*(s.length-1-n)+16}});for(var t=0;t<s.length;t++)for(var e=0;e<s.length;e++)w.select(".heat_map").selectAll(".row_"+t).selectAll(".column_"+e).select(".cell").transition().duration(2*k).attr({x:function(){for(var n=0;n<s.length;n++)if(h[e]==m[n])return c[t][e]=i[t][n],c[t][n]=i[t][e],A.left+31*(s.length-1-n)},y:function(){for(var n=0;n<s.length;n++)if(u[t]==d[n])return c[t][e]=i[n][e],c[n][e]=i[t][e],A.top+31*(s.length-1-n)}});w.select(".heat_map").selectAll(".row_border").data(s).transition().duration(2*k).attr({d:function(t,e){for(var n=0;n<s.length;n++)if(u[e]==d[n])return M([[A.left+0,A.top+31*(s.length-1-n)],[A.left+31*s.length,A.top+31*(s.length-1-n)]])}}),w.select(".heat_map").selectAll(".column_border").data(s).transition().duration(2*k).attr({d:function(t,e){for(var n=0;n<s.length;n++)if(h[e]==m[n])return M([[A.left+31*(s.length-1-n),A.top],[A.left+31*(s.length-1-n),A.top+31*s.length]])}}),w.select(".heat_map").selectAll(".send_comments_sum_label").data(u).transition().duration(2*k).attr({y:function(t,e){for(var n=0;n<u.length;n++)if(u[e]==d[n])return A.top+31*(u.length-1-n)+18}}),w.select(".heat_map").selectAll(".recieve_comments_sum_label").data(h).transition().duration(2*k).attr({x:function(t,e){for(var n=0;n<h.length;n++)if(h[e]==m[n])return A.left+31*(h.length-1-n)+16}})}}),w.select(".heat_map").select(".sort").append("text").attr("class","sort_name").text(l[z]).attr({x:32,y:32,"font-family":"sans-serif","font-size":"15px","text-anchor":"start","dominant-baseline":"middle",fill:"#777777",opacity:0}).transition().duration(k).delay(k).attr("opacity",1)}function r(){for(var t=0,e=0;e<i.length;e++)t=Math.max(t,Math.max.apply(null,i[e]));return t}function o(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}var s=t,i=e;console.log(s),console.log(i);var c=[];n();for(var f=[],p=[],u=[],h=[],d=0;d<s.length;d++){u.push(o(i[d]));for(var m=0,_=0;_<s.length;_++)m+=i[_][d];h.push(m)}var g=r(),x="#ae403d",v=960,b=540,y={top:50,right:100,bottom:0,left:100},A={top:100,right:0,bottom:0,left:100},w=d3.select("body").append("svg").attr({"class":"comment_graph",width:v,height:b}),k=800,z=0,M=d3.svg.line().x(function(t){return t[0]}).y(function(t){return t[1]});a(),l()};